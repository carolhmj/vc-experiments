"use strict";(self.webpackChunkvc_experiments=self.webpackChunkvc_experiments||[]).push([[574],{8574:(e,t,n)=>{n.r(t),n.d(t,{DefaultSceneWithTexture:()=>C,default:()=>P});var o=n(4147),i=n(3579),a=n(972),r=n(6409),s=n(3415),l=n(9714),c=n(4684);const d=n.p+"9b31293ea96c8dfa518b45622da82a13.jpg";var u,h=n(3789),p=(n(1723),n(1034)),m=function(){function e(e){this._zoomStep=1,this._rotateStep=p.w1W.ToRadians(45),this._panStep=.5,this._camera=e,this._camera.storeState()}return e.prototype.processCommand=function(e){if(console.log("parse commands on text",e),console.log("times repeat",1),"zoom"===e.action){var t=1*this._zoomStep;"out"===e.modifier?(console.log("zoom out"),this._camera.radius+=t):(console.log("zoom in"),this._camera.radius-=t)}if("rotate"===e.action||"spin"===e.action||"look"===e.action){var n=this._rotateStep;e.value&&(n=e.value);var o=1*n;console.log(o),"left"===e.modifier?this._camera.alpha-=o:"right"===e.modifier?this._camera.alpha+=o:"up"===e.modifier?this._camera.beta-=o:this._camera.beta+=o}if("pan"===e.action||"move"===e.action){var i=this._panStep;e.value&&(i=e.value),console.log("pan amt",i);var r=1*i;"left"===e.modifier?this._camera.target.addInPlace(this._camera.getDirection(a.P.Left()).scale(r)):"right"===e.modifier?this._camera.target.addInPlace(this._camera.getDirection(a.P.Right()).scale(r)):"up"===e.modifier?this._camera.target.addInPlace(this._camera.getDirection(a.P.Up()).scale(r)):"down"===e.modifier&&this._camera.target.addInPlace(this._camera.getDirection(a.P.Down()).scale(r))}"reset"===e.action&&this._camera.restoreState()},e}(),f=function(){function e(){this._processors=[]}return e.prototype.addProcessor=function(e){this._processors.indexOf(e)<0&&this._processors.push(e)},e.prototype.removeProcessor=function(e){var t=this._processors.indexOf(e);t>=0&&this._processors.splice(t,1)},e.prototype._produceCommand=function(e){for(var t=0,n=this._processors;t<n.length;t++)n[t].processCommand(e)},e.prototype.start=function(){},e.prototype.stop=function(e){e&&e()},e}(),_=n(8307),v=(u=function(e,t){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},u(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(e){function t(){var t=e.call(this)||this;t._numRestingSamples=3,t._timingIntervals=700,t._verticalAngleDiff=s.Tools.ToRadians(20),t._horizontalAngleDiff=s.Tools.ToRadians(20),t._verticalAngleChange=s.Tools.ToRadians(1),t._horizontalAngleChange=s.Tools.ToRadians(1),t._runDetection=function(){console.log("start detect"),t._restingPosition.calculated?t._runningId=window.setTimeout(t._runDetection,100):t._runningId=window.setTimeout(t._runDetection,t._timingIntervals),t._human.detect(t._video,{face:{enabled:!0,detector:{rotation:!0},mesh:{enabled:!0}},gesture:{enabled:!1}}).then((function(e){var n;if(e.face&&e.face.length>0&&(null===(n=e.face[0].rotation)||void 0===n?void 0:n.angle)){var o=e.face[0].rotation.angle,i=o.pitch,a=o.yaw;t._accumulateInitialSamples(i,a)&&t._calculateCommand(i,a)}}))},t._restingPosition={pitch:0,yaw:0,numSamples:0,calculated:!1};var n=document.getElementById("videoContainer");if(n)t._videoContainer=n;else{t._videoContainer=document.createElement("div"),t._videoContainer.id="videoContainer",document.body.appendChild(t._videoContainer),t._videoContainer.style.position="absolute",t._videoContainer.style.top="10px",t._videoContainer.style.right="10px",t._videoContainer.style.width="350px",t._videoContainer.style.height="350px",t._videoContainer.style.background="black",t._videoContainer.style.display="flex",t._videoContainer.style.alignItems="center",t._videoContainer.style.justifyContent="center";var o=document.createElement("div");o.id="innerDiv",o.style.position="absolute",o.style.width="100%",o.style.height="100%",o.style.background="rgba(111, 111, 111, 0.5)",o.style.zIndex="100",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",t._videoContainer.appendChild(o);var i=document.createElement("div");i.id="innerDivText",i.style.color="white",i.innerHTML="WAITING FOR VIDEO",o.appendChild(i)}var a=document.getElementById("headPoseVideo");return a?t._video=a:(t._video=document.createElement("video"),t._video.id="headPoseVideo",t._videoContainer.appendChild(t._video),t._video.style.width="100%"),t._human=new _.p2({}),t}return v(t,e),t.prototype._accumulateInitialSamples=function(e,t){if(this._restingPosition.numSamples<this._numRestingSamples&&!this._restingPosition.calculated)this._restingPosition.pitch+=e,this._restingPosition.yaw+=t,this._restingPosition.numSamples+=1;else if(this._restingPosition.numSamples>=this._numRestingSamples&&!this._restingPosition.calculated){this._restingPosition.pitch/=this._restingPosition.numSamples,this._restingPosition.yaw/=this._restingPosition.numSamples,this._restingPosition.calculated=!0,console.log("average head position pitch and yaw in degrees",s.Tools.ToDegrees(this._restingPosition.pitch),s.Tools.ToDegrees(this._restingPosition.yaw));var n=this._videoContainer.children[0];console.log("overlay",n),n.style.visibility="hidden"}return this._restingPosition.calculated},t.prototype._calculateCommand=function(e,t){var n=e-this._restingPosition.pitch;Math.abs(n)>this._verticalAngleDiff&&this._produceCommand({action:"rotate",modifier:n<0?"up":"down",value:this._verticalAngleChange});var o=t-this._restingPosition.yaw;Math.abs(o)>this._horizontalAngleDiff&&this._produceCommand({action:"rotate",modifier:o>0?"right":"left",value:this._horizontalAngleChange})},t.prototype.start=function(){var e=this;console.log("start"),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){e._videoContainer.children[0].children[0].innerHTML="INITIALIZING DETECTION",e._video.srcObject=t,e._stream=t.getVideoTracks()[0],e._video.play(),e._runDetection()})).catch((function(e){console.error("Error:",e)}))},t.prototype.stop=function(e){var t;if(console.log("call stop"),null===(t=this._stream)||void 0===t||t.stop(),this._runningId){console.log("stop detection");var n=this._videoContainer.children[0];console.log("overlay",n),n.style.visibility="visible",clearTimeout(this._runningId)}e&&e()},t}(f),y=n(9859);const b=n.p+"22bbfea34feab50837a25e487165bba2.env",w=n.p+"10afca2f499c0a79b96145553ece366e.glb";n(9918);var C=function(){var e=this;this.createScene=function(t,u){return p=e,f=void 0,v=function(){var e,p,f,_,v,C,P,T,x,D,I,S,k;return function(e,t){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}(this,(function(E){switch(E.label){case 0:return e=new o.x(t),Promise.all([Promise.resolve().then(n.bind(n,1568)),n.e(596).then(n.t.bind(n,3596,23))]).then((function(e){console.log(e)})),(p=new i.Y("c",2.2,1,5,new a.P(0,0,0),e)).upperBetaLimit=1.5,p.upperRadiusLimit=8,p.lowerRadiusLimit=3,p.wheelDeltaPercentage=10,p.setTarget(new a.P(0,0,0)),p.attachControl(u,!0),new s.HemisphericLight("light",new a.P(0,1,0),e).intensity=.7,(f=new h.O("light-dir",new a.P(-1,-1,5),e)).intensity=.5,f.position.y=10,_=s.MeshBuilder.CreateGround("ground",{width:10,height:10}),(v=new s.PBRMaterial("ground material",e)).metallic=0,v.roughness=1,v.albedoTexture=new c.x(d,e),v.albedoTexture.uScale=5,v.albedoTexture.vScale=5,_.material=v,C=l.B.CreateFromPrefilteredData(b,e),(P=new s.DefaultRenderingPipeline).samples=4,P.bloomEnabled=!0,[4,r.n.ImportMeshAsync("","",w)];case 1:return(T=E.sent()).meshes[0].normalizeToUnitCube(),T.meshes[0].position.y=.5,e.createDefaultEnvironment({skyboxTexture:C,environmentTexture:C,createGround:!1,skyboxSize:10}).skyboxMaterial.primaryColor=new y.Wo(1,1,1),x=new g,D=new m(p),x.addProcessor(D),I=!1,S=Date.now(),k=function(e){var t=Date.now()-S>1e3;"Enter"===e.event.key&&t&&!I?(I=!0,console.log("start listening"),x.start(),S=Date.now()):"Enter"===e.event.key&&t&&I&&x.stop((function(){I=!1,console.log("stop listening"),S=Date.now()}))},e.onKeyboardObservable.add(k),[2,e]}}))},new((_=void 0)||(_=Promise))((function(e,t){function n(e){try{i(v.next(e))}catch(e){t(e)}}function o(e){try{i(v.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof _?i:new _((function(e){e(i)}))).then(n,o)}i((v=v.apply(p,f||[])).next())}));var p,f,_,v}};const P=new C}}]);
//# sourceMappingURL=574.babylonBundle.js.map